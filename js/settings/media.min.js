!function(e){function t(e){n.reset(),_.each(e,function(e,t){n.addItem(e)})}function i(){n.addItem({name:"",key:"image-size-"+(n.items.length+1),width:100,height:100,selectable:!1,crop:!0})}function s(){n=new a({el:e(".sizes-list").get(0)}),r=e(".sizes-list .placeholder"),t(l.sizes.current),e(".robocrop-sizes-table .save-theme").prop("disabled",!l.theme_sizes_enabled),e(".robocrop-sizes-table .load-theme").prop("disabled",!l.theme_sizes_enabled||!1===l.sizes.theme)}var o,a,n,r,l=wp_robocrop_settings.options;wp_robocrop_settings.l10n;e(document).on("change",'.robocrop-manage-sizes [type="checkbox"]',function(t){e(this).closest("tr").toggleClass("off",!e(this).prop("checked"))}),a=wp.media.View.extend({initialize:function(){return wp.media.View.prototype.initialize.apply(this,arguments),this.$placeholder=this.$(".placeholder"),this.items=[],this},addItem:function(e){this.$placeholder.parent().length>0&&this.$placeholder.remove();var t=new o({model:e,controller:this});return this.$el.append(t.render().el),this.items.push(t),this},removeItem:function(e){var t;return e.$el.remove(),0===this.$el.children().length&&this.$placeholder.appendTo(this.el),t=this.items.indexOf(e),t>-1&&this.items.splice(t,1),this},reset:function(){for(;this.items.length;)this.removeItem(this.items.pop());return this}}),SizeScaledView=wp.media.View.extend({tagName:"tr",className:"scaled-item",template:wp.template("robocrop-settings-scaled-size"),events:{'change [data-prop="scaled-key"]':function(t){var i=_.template("robocrop_sizes[<%= data.size_key %>][scaled][<%= data.key %>]"),s=_.extend(this.options.model,{key:e(t.target).val()}),o=i({data:s});this.$('[data-prop="scaled-factor"]').attr("name",o)},"click .remove-scaled":function(e){e.preventDefault(),this.$el.remove()}},render:function(){return wp.media.View.prototype.render.apply(this,arguments),this.$('[data-prop="scaled-key"]').val(this.options.model.key),this.$('[data-prop="scaled-factor"]').val(this.options.model.factor),this},prepare:function(){return this.options.model}}),o=wp.media.View.extend({tagName:"tr",className:"size-item",template:wp.template("robocrop-settings-size"),events:{"click .remove-size":function(e){e.preventDefault(),this.controller.removeItem(this)},"click .add-scaled":function(e){e.preventDefault(),this.addScaled({factor:2,key:"scaled",size_key:this.model.key})}},initialize:function(){return wp.media.View.prototype.initialize.apply(this,arguments),this},render:function(){var e=this;return wp.media.View.prototype.render.apply(this,arguments),this.$scaledList=this.$(".scaled .scaled-list"),_.each(this.options.model,function(t,i){var s=e.$('[data-prop="'+i+'"]');_.isBoolean(t)?s.prop("checked",t):_.isString(t)||_.isNumber(t)?s.val(t):"scaled"===i&&_.each(t,function(t,i){e.addScaled({factor:t,key:i,size_key:e.model.key})})}),this},addScaled:function(e){new SizeScaledView({model:e}).render().$el.appendTo(this.$scaledList)},prepare:function(){return this.options.model}}),e(document).ready(s).on("click",".robocrop-sizes-table .add",function(e){e.preventDefault(),i()}).on("click",".robocrop-sizes-table .reset",function(e){e.preventDefault(),t(l.sizes.original)}).on("click",".robocrop-sizes-table .load-theme",function(e){e.preventDefault(),t(l.sizes.theme)})}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lZGlhLmpzIl0sIm5hbWVzIjpbIiQiLCJzZXRTaXplcyIsInNpemVzIiwic2l6ZXNWaWV3IiwicmVzZXQiLCJfIiwiZWFjaCIsInNpemUiLCJpIiwiYWRkSXRlbSIsImFkZFNpemUiLCJuYW1lIiwia2V5IiwiaXRlbXMiLCJsZW5ndGgiLCJ3aWR0aCIsImhlaWdodCIsInNlbGVjdGFibGUiLCJjcm9wIiwiaW5pdCIsIlNpemVzVGFibGVWaWV3IiwiZWwiLCJnZXQiLCIkcGxhY2Vob2xkZXIiLCJvcHQiLCJjdXJyZW50IiwicHJvcCIsInRoZW1lX3NpemVzX2VuYWJsZWQiLCJ0aGVtZSIsIlNpemVSb3dWaWV3Iiwid3Bfcm9ib2Nyb3Bfc2V0dGluZ3MiLCJvcHRpb25zIiwibDEwbiIsImRvY3VtZW50Iiwib24iLCJlIiwidGhpcyIsImNsb3Nlc3QiLCJ0b2dnbGVDbGFzcyIsIndwIiwibWVkaWEiLCJWaWV3IiwiZXh0ZW5kIiwiaW5pdGlhbGl6ZSIsInByb3RvdHlwZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiZGF0YSIsInBhcmVudCIsInJlbW92ZSIsIml0ZW0iLCJtb2RlbCIsImNvbnRyb2xsZXIiLCIkZWwiLCJhcHBlbmQiLCJyZW5kZXIiLCJwdXNoIiwicmVtb3ZlSXRlbSIsImlkeCIsImNoaWxkcmVuIiwiYXBwZW5kVG8iLCJpbmRleE9mIiwic3BsaWNlIiwicG9wIiwiU2l6ZVNjYWxlZFZpZXciLCJ0YWdOYW1lIiwiY2xhc3NOYW1lIiwidGVtcGxhdGUiLCJldmVudHMiLCJjaGFuZ2UgW2RhdGEtcHJvcD1cInNjYWxlZC1rZXlcIl0iLCJ0cGwiLCJ0YXJnZXQiLCJ2YWwiLCJhdHRyIiwiY2xpY2sgLnJlbW92ZS1zY2FsZWQiLCJwcmV2ZW50RGVmYXVsdCIsImZhY3RvciIsInByZXBhcmUiLCJjbGljayAucmVtb3ZlLXNpemUiLCJjbGljayAuYWRkLXNjYWxlZCIsImFkZFNjYWxlZCIsInNpemVfa2V5Iiwic2VsZiIsIiRzY2FsZWRMaXN0IiwiJGlucCIsImlzQm9vbGVhbiIsImlzU3RyaW5nIiwiaXNOdW1iZXIiLCJyZWFkeSIsIm9yaWdpbmFsIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFVQSxHQW9JVCxRQUFTQyxHQUFVQyxHQUNsQkMsRUFBVUMsUUFDVkMsRUFBRUMsS0FBTUosRUFBTyxTQUFVSyxFQUFNQyxHQUM5QkwsRUFBVU0sUUFBU0YsS0FHckIsUUFBU0csS0FDUlAsRUFBVU0sU0FDVEUsS0FBSyxHQUNMQyxJQUFJLGVBQWlCVCxFQUFVVSxNQUFNQyxPQUFTLEdBQzlDQyxNQUFNLElBQ05DLE9BQU8sSUFDUEMsWUFBVyxFQUNYQyxNQUFLLElBR1AsUUFBU0MsS0FDUmhCLEVBQVksR0FBSWlCLElBQWtCQyxHQUFJckIsRUFBRSxlQUFlc0IsSUFBSSxLQUMzREMsRUFBZXZCLEVBQUUsNEJBQ2pCQyxFQUFVdUIsRUFBSXRCLE1BQU11QixTQUNwQnpCLEVBQUUscUNBQXFDMEIsS0FBSyxZQUFjRixFQUFJRyxxQkFDOUQzQixFQUFFLHFDQUNBMEIsS0FBSyxZQUFjRixFQUFJRyxzQkFBMkMsSUFBcEJILEVBQUl0QixNQUFNMEIsT0F6SjNELEdBRUNDLEdBQ0FULEVBQ0FqQixFQUNBb0IsRUFMR0MsRUFBTU0scUJBQXFCQyxPQUN2QkQsc0JBQXFCRSxJQU03QmhDLEdBQUVpQyxVQUFVQyxHQUFHLFNBQVMsMkNBQTJDLFNBQVNDLEdBQzNFbkMsRUFBRW9DLE1BQU1DLFFBQVEsTUFBTUMsWUFBWSxPQUFPdEMsRUFBRW9DLE1BQU1WLEtBQUssY0FFdkROLEVBQWlCbUIsR0FBR0MsTUFBTUMsS0FBS0MsUUFDOUJDLFdBQVcsV0FJVixNQUhBSixJQUFHQyxNQUFNQyxLQUFLRyxVQUFVRCxXQUFXRSxNQUFNVCxLQUFLVSxXQUM5Q1YsS0FBS2IsYUFBZWEsS0FBS3BDLEVBQUUsZ0JBQzNCb0MsS0FBS3ZCLFNBQ0V1QixNQUVSM0IsUUFBUSxTQUFVc0MsR0FDWlgsS0FBS2IsYUFBYXlCLFNBQVNsQyxPQUFTLEdBQ3hDc0IsS0FBS2IsYUFBYTBCLFFBRW5CLElBQUlDLEdBQU8sR0FBSXJCLElBQ2RzQixNQUFTSixFQUNUSyxXQUFhaEIsTUFJZCxPQUZBQSxNQUFLaUIsSUFBSUMsT0FBUUosRUFBS0ssU0FBU2xDLElBQy9CZSxLQUFLdkIsTUFBTTJDLEtBQU1OLEdBQ1ZkLE1BRVJxQixXQUFXLFNBQVVQLEdBQ3BCLEdBQUlRLEVBU0osT0FSQVIsR0FBS0csSUFBSUosU0FDMkIsSUFBL0JiLEtBQUtpQixJQUFJTSxXQUFXN0MsUUFDeEJzQixLQUFLYixhQUFhcUMsU0FBU3hCLEtBQUtmLElBRWpDcUMsRUFBTXRCLEtBQUt2QixNQUFNZ0QsUUFBU1gsR0FDckJRLEdBQU8sR0FDWHRCLEtBQUt2QixNQUFNaUQsT0FBT0osRUFBSSxHQUVoQnRCLE1BRVJoQyxNQUFNLFdBQ0wsS0FBT2dDLEtBQUt2QixNQUFNQyxRQUNqQnNCLEtBQUtxQixXQUFZckIsS0FBS3ZCLE1BQU1rRCxNQUU3QixPQUFPM0IsU0FHVDRCLGVBQWlCekIsR0FBR0MsTUFBTUMsS0FBS0MsUUFDOUJ1QixRQUFXLEtBQ1hDLFVBQVksY0FDWkMsU0FBVzVCLEdBQUc0QixTQUFTLGlDQUN2QkMsUUFDQ0Msa0NBQW9DLFNBQVNsQyxHQUM1QyxHQUFJbUMsR0FBTWpFLEVBQUU4RCxTQUFTLGlFQUNwQnBCLEVBQU8xQyxFQUFFcUMsT0FBUU4sS0FBS0wsUUFBUW9CLE9BQVF2QyxJQUFJWixFQUFFbUMsRUFBRW9DLFFBQVFDLFFBQ3REN0QsRUFBTzJELEdBQUt2QixLQUFLQSxHQUNsQlgsTUFBS3BDLEVBQUUsK0JBQStCeUUsS0FBSyxPQUFPOUQsSUFFbkQrRCx1QkFBeUIsU0FBU3ZDLEdBQ2pDQSxFQUFFd0MsaUJBQ0Z2QyxLQUFLaUIsSUFBSUosV0FHWE0sT0FBUSxXQUtQLE1BSEFoQixJQUFHQyxNQUFNQyxLQUFLRyxVQUFVVyxPQUFPVixNQUFNVCxLQUFLVSxXQUMxQ1YsS0FBS3BDLEVBQUUsNEJBQTRCd0UsSUFBSXBDLEtBQUtMLFFBQVFvQixNQUFNdkMsS0FDMUR3QixLQUFLcEMsRUFBRSwrQkFBK0J3RSxJQUFJcEMsS0FBS0wsUUFBUW9CLE1BQU15QixRQUN0RHhDLE1BRVJ5QyxRQUFRLFdBQ1AsTUFBT3pDLE1BQUtMLFFBQVFvQixTQUd0QnRCLEVBQWNVLEdBQUdDLE1BQU1DLEtBQUtDLFFBQzNCdUIsUUFBUSxLQUNSQyxVQUFVLFlBQ1ZDLFNBQVU1QixHQUFHNEIsU0FBUywwQkFDdEJDLFFBQ0NVLHFCQUF1QixTQUFTM0MsR0FDL0JBLEVBQUV3QyxpQkFDRnZDLEtBQUtnQixXQUFXSyxXQUFZckIsT0FFN0IyQyxvQkFBc0IsU0FBUzVDLEdBQzlCQSxFQUFFd0MsaUJBQ0Z2QyxLQUFLNEMsV0FDSkosT0FBTyxFQUNQaEUsSUFBSSxTQUNKcUUsU0FBUzdDLEtBQUtlLE1BQU12QyxRQUl2QitCLFdBQVcsV0FFVixNQURBSixJQUFHQyxNQUFNQyxLQUFLRyxVQUFVRCxXQUFXRSxNQUFNVCxLQUFLVSxXQUN2Q1YsTUFFUm1CLE9BQU8sV0FDTixHQUFJMkIsR0FBTzlDLElBb0JYLE9BbkJBRyxJQUFHQyxNQUFNQyxLQUFLRyxVQUFVVyxPQUFPVixNQUFNVCxLQUFLVSxXQUMxQ1YsS0FBSytDLFlBQWMvQyxLQUFLcEMsRUFBRSx3QkFDMUJLLEVBQUVDLEtBQUs4QixLQUFLTCxRQUFRb0IsTUFBTyxTQUFVcUIsRUFBSzlDLEdBQ3pDLEdBQUkwRCxHQUFPRixFQUFLbEYsRUFBRSxlQUFlMEIsRUFBSyxLQUVsQ3JCLEdBQUVnRixVQUFVYixHQUNmWSxFQUFLMUQsS0FBSyxVQUFVOEMsR0FDVG5FLEVBQUVpRixTQUFTZCxJQUFRbkUsRUFBRWtGLFNBQVNmLEdBQ3pDWSxFQUFLWixJQUFJQSxHQUNVLFdBQVQ5QyxHQUNWckIsRUFBRUMsS0FBS2tFLEVBQUksU0FBVUksRUFBUWhFLEdBQzVCc0UsRUFBS0YsV0FDSkosT0FBT0EsRUFDUGhFLElBQUlBLEVBQ0pxRSxTQUFTQyxFQUFLL0IsTUFBTXZDLFVBS2pCd0IsTUFFUjRDLFVBQVUsU0FBU2pDLEdBQ0wsR0FBSWlCLGlCQUNoQmIsTUFBTUosSUFHQVEsU0FBU0YsSUFBSU8sU0FBU3hCLEtBQUsrQyxjQUVuQ04sUUFBUSxXQUNQLE1BQU96QyxNQUFLTCxRQUFRb0IsU0E0QnRCbkQsRUFBRWlDLFVBQ0F1RCxNQUFNckUsR0FDTmUsR0FBRyxRQUFRLDZCQUE2QixTQUFTQyxHQUNqREEsRUFBRXdDLGlCQUNGakUsTUFFQXdCLEdBQUcsUUFBUSwrQkFBK0IsU0FBU0MsR0FDbkRBLEVBQUV3QyxpQkFDRjFFLEVBQVV1QixFQUFJdEIsTUFBTXVGLFlBRXBCdkQsR0FBRyxRQUFRLG9DQUFxQyxTQUFTQyxHQUN6REEsRUFBRXdDLGlCQUNGMUUsRUFBVXVCLEVBQUl0QixNQUFNMEIsVUFHcEI4RCIsImZpbGUiOiJtZWRpYS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oJCl7XG5cdHZhciBvcHQgPSB3cF9yb2JvY3JvcF9zZXR0aW5ncy5vcHRpb25zLFxuXHRcdGwxMG4gPSB3cF9yb2JvY3JvcF9zZXR0aW5ncy5sMTBuLFxuXHRcdFNpemVSb3dWaWV3LFxuXHRcdFNpemVzVGFibGVWaWV3LFxuXHRcdHNpemVzVmlldyxcblx0XHQkcGxhY2Vob2xkZXI7XG5cdC8vIHRvZ2dsZSBzaXplcyBzZXR0aW5nc1xuXHQkKGRvY3VtZW50KS5vbignY2hhbmdlJywnLnJvYm9jcm9wLW1hbmFnZS1zaXplcyBbdHlwZT1cImNoZWNrYm94XCJdJyxmdW5jdGlvbihlKXtcblx0XHQkKHRoaXMpLmNsb3Nlc3QoJ3RyJykudG9nZ2xlQ2xhc3MoJ29mZicsISQodGhpcykucHJvcCgnY2hlY2tlZCcpKVxuXHR9KTtcblx0U2l6ZXNUYWJsZVZpZXcgPSB3cC5tZWRpYS5WaWV3LmV4dGVuZCh7XG5cdFx0aW5pdGlhbGl6ZTpmdW5jdGlvbigpe1xuXHRcdFx0d3AubWVkaWEuVmlldy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XG5cdFx0XHR0aGlzLiRwbGFjZWhvbGRlciA9IHRoaXMuJCgnLnBsYWNlaG9sZGVyJyk7XG5cdFx0XHR0aGlzLml0ZW1zID0gW107XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdGFkZEl0ZW06ZnVuY3Rpb24oIGRhdGEgKSB7XG5cdFx0XHRpZiAoIHRoaXMuJHBsYWNlaG9sZGVyLnBhcmVudCgpLmxlbmd0aCA+IDAgKSB7XG5cdFx0XHRcdHRoaXMuJHBsYWNlaG9sZGVyLnJlbW92ZSgpO1xuXHRcdFx0fVxuXHRcdFx0dmFyIGl0ZW0gPSBuZXcgU2l6ZVJvd1ZpZXcoe1xuXHRcdFx0XHRtb2RlbFx0XHQ6IGRhdGEsXG5cdFx0XHRcdGNvbnRyb2xsZXJcdDogdGhpc1xuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLiRlbC5hcHBlbmQoIGl0ZW0ucmVuZGVyKCkuZWwgKTtcblx0XHRcdHRoaXMuaXRlbXMucHVzaCggaXRlbSApO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRyZW1vdmVJdGVtOmZ1bmN0aW9uKCBpdGVtICkge1xuXHRcdFx0dmFyIGlkeDtcblx0XHRcdGl0ZW0uJGVsLnJlbW92ZSgpO1xuXHRcdFx0aWYgKCB0aGlzLiRlbC5jaGlsZHJlbigpLmxlbmd0aCA9PT0gMCApIHtcblx0XHRcdFx0dGhpcy4kcGxhY2Vob2xkZXIuYXBwZW5kVG8odGhpcy5lbCk7XG5cdFx0XHR9XG5cdFx0XHRpZHggPSB0aGlzLml0ZW1zLmluZGV4T2YoIGl0ZW0gKTtcblx0XHRcdGlmICggaWR4ID4gLTEgKSB7XG5cdFx0XHRcdHRoaXMuaXRlbXMuc3BsaWNlKGlkeCwxKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0cmVzZXQ6ZnVuY3Rpb24oKSB7XG5cdFx0XHR3aGlsZSggdGhpcy5pdGVtcy5sZW5ndGggKSB7XG5cdFx0XHRcdHRoaXMucmVtb3ZlSXRlbSggdGhpcy5pdGVtcy5wb3AoKSApXG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdH0pO1xuXHRTaXplU2NhbGVkVmlldyA9IHdwLm1lZGlhLlZpZXcuZXh0ZW5kKHtcblx0XHR0YWdOYW1lXHRcdDogJ3RyJyxcblx0XHRjbGFzc05hbWVcdDogJ3NjYWxlZC1pdGVtJyxcblx0XHR0ZW1wbGF0ZVx0OiB3cC50ZW1wbGF0ZSgncm9ib2Nyb3Atc2V0dGluZ3Mtc2NhbGVkLXNpemUnKSxcblx0XHRldmVudHNcdFx0OiB7XG5cdFx0XHQnY2hhbmdlIFtkYXRhLXByb3A9XCJzY2FsZWQta2V5XCJdJyA6IGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0dmFyIHRwbCA9IF8udGVtcGxhdGUoJ3JvYm9jcm9wX3NpemVzWzwlPSBkYXRhLnNpemVfa2V5ICU+XVtzY2FsZWRdWzwlPSBkYXRhLmtleSAlPl0nKSxcblx0XHRcdFx0XHRkYXRhID0gXy5leHRlbmQoIHRoaXMub3B0aW9ucy5tb2RlbCwge2tleTokKGUudGFyZ2V0KS52YWwoKX0gKSxcblx0XHRcdFx0XHRuYW1lID0gdHBsKHtkYXRhOmRhdGF9KTtcblx0XHRcdFx0dGhpcy4kKCdbZGF0YS1wcm9wPVwic2NhbGVkLWZhY3RvclwiXScpLmF0dHIoJ25hbWUnLG5hbWUgKTtcblx0XHRcdH0sXG5cdFx0XHQnY2xpY2sgLnJlbW92ZS1zY2FsZWQnIDogZnVuY3Rpb24oZSl7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy4kZWwucmVtb3ZlKCk7XG5cdFx0XHR9LFxuXHRcdH0sXG5cdFx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHdwLm1lZGlhLlZpZXcucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XG5cdFx0XHR0aGlzLiQoJ1tkYXRhLXByb3A9XCJzY2FsZWQta2V5XCJdJykudmFsKHRoaXMub3B0aW9ucy5tb2RlbC5rZXkpO1xuXHRcdFx0dGhpcy4kKCdbZGF0YS1wcm9wPVwic2NhbGVkLWZhY3RvclwiXScpLnZhbCh0aGlzLm9wdGlvbnMubW9kZWwuZmFjdG9yKTtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH0sXG5cdFx0cHJlcGFyZTpmdW5jdGlvbigpe1xuXHRcdFx0cmV0dXJuIHRoaXMub3B0aW9ucy5tb2RlbDtcblx0XHR9XG5cdH0pO1xuXHRTaXplUm93VmlldyA9IHdwLm1lZGlhLlZpZXcuZXh0ZW5kKHtcblx0XHR0YWdOYW1lOid0cicsXG5cdFx0Y2xhc3NOYW1lOidzaXplLWl0ZW0nLFxuXHRcdHRlbXBsYXRlOiB3cC50ZW1wbGF0ZSgncm9ib2Nyb3Atc2V0dGluZ3Mtc2l6ZScpLFxuXHRcdGV2ZW50czp7XG5cdFx0XHQnY2xpY2sgLnJlbW92ZS1zaXplJ1x0OiBmdW5jdGlvbihlKXtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR0aGlzLmNvbnRyb2xsZXIucmVtb3ZlSXRlbSggdGhpcyApO1xuXHRcdFx0fSxcblx0XHRcdCdjbGljayAuYWRkLXNjYWxlZCcgOiBmdW5jdGlvbihlKSB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5hZGRTY2FsZWQoe1xuXHRcdFx0XHRcdGZhY3RvcjoyLFxuXHRcdFx0XHRcdGtleTonc2NhbGVkJyxcblx0XHRcdFx0XHRzaXplX2tleTp0aGlzLm1vZGVsLmtleVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGluaXRpYWxpemU6ZnVuY3Rpb24oKXtcblx0XHRcdHdwLm1lZGlhLlZpZXcucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcyxhcmd1bWVudHMpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblx0XHRyZW5kZXI6ZnVuY3Rpb24oKXtcblx0XHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcdHdwLm1lZGlhLlZpZXcucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLGFyZ3VtZW50cyk7XG5cdFx0XHR0aGlzLiRzY2FsZWRMaXN0ID0gdGhpcy4kKCcuc2NhbGVkIC5zY2FsZWQtbGlzdCcpO1xuXHRcdFx0Xy5lYWNoKHRoaXMub3B0aW9ucy5tb2RlbCwgZnVuY3Rpb24oIHZhbCwgcHJvcCkge1xuXHRcdFx0XHR2YXIgJGlucCA9IHNlbGYuJCgnW2RhdGEtcHJvcD1cIicrcHJvcCsnXCJdJyksXG5cdFx0XHRcdFx0c2NhbGVkO1xuXHRcdFx0XHRpZiAoXy5pc0Jvb2xlYW4odmFsKSApIHtcblx0XHRcdFx0XHQkaW5wLnByb3AoJ2NoZWNrZWQnLHZhbCk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoIF8uaXNTdHJpbmcodmFsKSB8fCBfLmlzTnVtYmVyKHZhbCkgKSB7XG5cdFx0XHRcdFx0JGlucC52YWwodmFsKTtcblx0XHRcdFx0fSBlbHNlIGlmIChwcm9wID09PSAnc2NhbGVkJykge1xuXHRcdFx0XHRcdF8uZWFjaCh2YWwsZnVuY3Rpb24oIGZhY3Rvciwga2V5ICl7XG5cdFx0XHRcdFx0XHRzZWxmLmFkZFNjYWxlZCh7XG5cdFx0XHRcdFx0XHRcdGZhY3RvcjpmYWN0b3IsXG5cdFx0XHRcdFx0XHRcdGtleTprZXksXG5cdFx0XHRcdFx0XHRcdHNpemVfa2V5OnNlbGYubW9kZWwua2V5XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXHRcdGFkZFNjYWxlZDpmdW5jdGlvbihkYXRhKXtcblx0XHRcdHZhciBzY2FsZWQgPSBuZXcgU2l6ZVNjYWxlZFZpZXcoe1xuXHRcdFx0XHRtb2RlbDpkYXRhXG5cdFx0XHR9KTtcblxuXHRcdFx0c2NhbGVkLnJlbmRlcigpLiRlbC5hcHBlbmRUbyh0aGlzLiRzY2FsZWRMaXN0KTtcblx0XHR9LFxuXHRcdHByZXBhcmU6ZnVuY3Rpb24oKXtcblx0XHRcdHJldHVybiB0aGlzLm9wdGlvbnMubW9kZWw7XG5cdFx0fVxuXHR9KTtcblx0ZnVuY3Rpb24gc2V0U2l6ZXMoIHNpemVzICkge1xuXHRcdHNpemVzVmlldy5yZXNldCgpO1xuXHRcdF8uZWFjaCggc2l6ZXMsIGZ1bmN0aW9uKCBzaXplLCBpICl7XG5cdFx0XHRzaXplc1ZpZXcuYWRkSXRlbSggc2l6ZSApO1xuXHRcdH0pO1xuXHR9XG5cdGZ1bmN0aW9uIGFkZFNpemUoKSB7XG5cdFx0c2l6ZXNWaWV3LmFkZEl0ZW0oe1xuXHRcdFx0bmFtZTonJyxcblx0XHRcdGtleTonaW1hZ2Utc2l6ZS0nICsgKHNpemVzVmlldy5pdGVtcy5sZW5ndGggKyAxKSxcblx0XHRcdHdpZHRoOjEwMCxcblx0XHRcdGhlaWdodDoxMDAsXG5cdFx0XHRzZWxlY3RhYmxlOmZhbHNlLFxuXHRcdFx0Y3JvcDp0cnVlLFxuXHRcdH0pO1xuXHR9XG5cdGZ1bmN0aW9uIGluaXQoKSB7XG5cdFx0c2l6ZXNWaWV3ID0gbmV3IFNpemVzVGFibGVWaWV3KCB7IGVsOiAkKCcuc2l6ZXMtbGlzdCcpLmdldCgwKSB9ICk7XG5cdFx0JHBsYWNlaG9sZGVyID0gJCgnLnNpemVzLWxpc3QgLnBsYWNlaG9sZGVyJyk7XG5cdFx0c2V0U2l6ZXMoIG9wdC5zaXplcy5jdXJyZW50ICk7XG5cdFx0JCgnLnJvYm9jcm9wLXNpemVzLXRhYmxlIC5zYXZlLXRoZW1lJykucHJvcCgnZGlzYWJsZWQnLCAhIG9wdC50aGVtZV9zaXplc19lbmFibGVkICk7XG5cdFx0JCgnLnJvYm9jcm9wLXNpemVzLXRhYmxlIC5sb2FkLXRoZW1lJylcblx0XHRcdC5wcm9wKCdkaXNhYmxlZCcsICEgb3B0LnRoZW1lX3NpemVzX2VuYWJsZWQgfHwgb3B0LnNpemVzLnRoZW1lID09PSBmYWxzZSApO1xuXHR9XG5cblx0JChkb2N1bWVudClcblx0XHQucmVhZHkoaW5pdClcblx0XHQub24oJ2NsaWNrJywnLnJvYm9jcm9wLXNpemVzLXRhYmxlIC5hZGQnLGZ1bmN0aW9uKGUpe1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0YWRkU2l6ZSgpO1xuXHRcdH0pXG5cdFx0Lm9uKCdjbGljaycsJy5yb2JvY3JvcC1zaXplcy10YWJsZSAucmVzZXQnLGZ1bmN0aW9uKGUpe1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0c2V0U2l6ZXMoIG9wdC5zaXplcy5vcmlnaW5hbCApO1xuXHRcdH0pXG5cdFx0Lm9uKCdjbGljaycsJy5yb2JvY3JvcC1zaXplcy10YWJsZSAubG9hZC10aGVtZScsIGZ1bmN0aW9uKGUpe1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0c2V0U2l6ZXMoIG9wdC5zaXplcy50aGVtZSApO1xuXHRcdH0pO1xuXG59KShqUXVlcnkpXG4iXX0=
